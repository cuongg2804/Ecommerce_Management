extends ../../layouts/blank.pug
include ../../mixin/pagination.pug
block main
  ul.list-group.list-group-horizontal-md.mb-3(breadcumb-folder)
 

  .card
    .card-header
      .row.align-items-center.g-2
        .col-lg-8
          h4.card-title Danh sách folder
        .col-lg-4
          form(form-create-folder)
            .input-group
              input(
                class="form-control"
                placeholder="Tên folder" 
                type="text"
                name="folderName"
              )
              button.btn.btn-secondary Tạo folder
        // end col
      // end row
    // end card-header
    .card-body.pt-0
      .table-responsive
        table.table.table-striped.mb-0
          thead.table-light
            tr
              th Tên
              th Ngày tạo
              th.text-end Hành động
          tbody
            each item in folderList
              tr
                td
                  a(
                    href="javascript:;"
                    button-to-folder
                    folderPath=item.name
                    ) 
                    .d-inline-flex.justify-content-center.align-items-center.thumb-md.bg-secondary-subtle.rounded.mx-auto.me-1
                      i.fa-solid.fa-folder.fs-18.align-self-center.mb-0.text-secondary
                    span #{item.name}
                td #{item.createdAtFormat}
                td.text-end
                  a(
                    href="javascript:;"
                    button-delete-folder
                    folderPath=item.name
                  )
                    i.las.la-trash-alt.text-secondary.fs-18.ms-1
    // end card-body

  .card
    .card-header
      .row.align-items-center
        .col
          h4.card-title Danh sách file
        // end col
      // end row
    // end card-header
    .card-body.pt-0
      .table-responsive.text-center
        table.table.table-striped.mb-0
          thead.table-light
            tr
              th Tên
              th Ngày tạo
              th Kích thước
              th Hành động
          tbody
            each item in mediaList
              tr
                td
                  if(item.mimetype.includes("image"))
                    img.rounded.thumb-md.me-1.d-inline(src=`${domainCDN}/${item.folder}/${item.filename}`)
                    span #{item.filename}
                  if(item.mimetype.includes("audio"))
                    .d-inline-flex.justify-content-center.align-items-center.thumb-md.bg-secondary-subtle.rounded.mx-auto.me-1
                      i.fa-solid.fa-headphones.fs-18.align-self-center.mb-0.text-secondary
                    span #{item.filename}
                  if(item.mimetype.includes("video"))
                    .d-inline-flex.justify-content-center.align-items-center.thumb-md.bg-secondary-subtle.rounded.mx-auto.me-1
                      i.fa-solid.fa-video.fs-18.align-self-center.mb-0.text-secondary
                    span #{item.filename}
                  if(item.mimetype.includes("application"))
                    .d-inline-flex.justify-content-center.align-items-center.thumb-md.bg-secondary-subtle.rounded.mx-auto.me-1
                      i.fa-solid.fa-file-pdf.fs-18.align-self-center.mb-0.text-secondary
                    span #{item.filename}
                td #{item.createdFormatAt}
                td #{item.sizeFormat}
                td
                  a(
                    href="javascript:;"
                    button-copy
                    data-content=`/${item.folder}/${item.filename}`
                  )
                    i.las.la-copy.text-secondary.fs-18.ms-1
                  a(
                    href="javascript:;"
                    button-preview-file
                    data-content=`${domainCDN}/${item.folder}/${item.filename}`
                    mimetype= item.mimetype
                    data-bs-toggle="modal" 
                    data-bs-target="#modalPreviewFile"
                  )
                    i.las.la-eye.text-secondary.fs-18.ms-1
                  a(href=`${domainCDN}/${item.folder}/${item.filename}?type=download`)
                    i.las.la-download.text-secondary.fs-18.ms-1
                  a(
                    href="javascript:;"
                    button-change-file-name
                    data-file-name=item.filename
                    data-file-id=item.id
                    mimetype= item.mimetype
                    data-bs-toggle="modal" 
                    data-bs-target="#modalChangeFileName"
                  )
                    i.las.la-pen.text-secondary.fs-18.ms-1
                  a(
                    href="javascript:;"
                    button-delete-file
                    data-file-name=item.filename
                    data-file-id=item.id
                  )
                    i.las.la-trash-alt.text-secondary.fs-18.ms-1
        +pagination(pagination)
         
  .card
    .card-header
      .row.align-items-center
        .col
          h4.card-title Upload file
        // end col
      // end row
    // end card-header
    .card-body.pt-0
      div(id="uppy-upload")
    // end card-body
  #modalPreviewFile.modal.fade(
    aria-hidden="true" 
    tabindex="-1"
    )
    .modal-dialog.modal-dialog-centered.modal-lg
      .modal-content
        .modal-header
          h5.modal-title Preview
          button.btn-close(
            aria-label="Close" 
            data-bs-dismiss="modal" 
            type="button"
            )
        .modal-body
          .inner-preview-file
        .modal-footer
          button.btn.btn-secondary(
            data-bs-dismiss="modal" 
            type="button"
            ) Đóng
  #modalChangeFileName.modal.fade(
    aria-hidden="true" 
    tabindex="-1"
    )
    .modal-dialog.modal-dialog-centered.modal-lg
      .modal-content
        .modal-header
          h5.modal-title Đổi tên file
          button.btn-close(
            aria-label="Close" 
            data-bs-dismiss="modal" 
            type="button"
            )
        .modal-body
          form(
            form-change-file-name
            )
            .mb-3(hidden)
              label(class="form-label") Id
              input(type="text" class="form-control" name="fileId" )
            .mb-3
              label(class="form-label") Tên file
              input(type="text" class="form-control" name="fileName")
            button.btn.btn-primary(type="submit") Cập nhật

          
